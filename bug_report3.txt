Some bugs in 3rd file
